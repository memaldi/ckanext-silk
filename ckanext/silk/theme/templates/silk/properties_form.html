<form 
  id="resource-properties" 
  action="/silk/properties" 
  method="post"
  class="form-horizontal"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:py="http://genshi.edgewall.org/"
  xmlns:xi="http://www.w3.org/2001/XInclude">
  
  <script language="JavaScript">
            
    function metric_params(element) {
        document.getElementById('special-params').innerHTML = '';
        metric = element.value;
        desc = '';
        if (metric == 'levenshteinDistance') {
            desc = 'Levenshtein distance. The minimum number of edits needed to transform one string into the other, with the allowable edit operations being insertion, deletion, or substitution of a single character.';
        } else if (metric == 'levenshtein') {
            desc = 'The levensthein distance normalized to the interval [0,1].';
        } else if (metric == 'jaro') {
            desc = 'Jaro distance metric. Simple distance metric originally developed to compare person names.';
        } else if (metric == 'jaroWinkler') {
            desc = 'Jaro-Winkler distance measure. The Jaro–Winkler distance metric is designed and best suited for short strings such as person names.';
        } else if (metric == 'equality') {
            desc = '0 if strings are equal, 1 otherwise.';
        } else if (metric == 'inequality') {
            desc = '1 if strings are equal, 0 otherwise.';
        } else if (metric == 'jaccard') {
            desc = 'Jaccard distance coefficient.';
        } else if (metric == 'dice') {
            desc = 'Dice distance coefficient.';
        } else if (metric == 'softjaccard') {
            desc = 'Soft Jaccard similarity coefficient. Same as Jaccard distance but values within an levenhstein distance of ‘maxDistance’ are considered equivalent.';
        } else if (metric == 'num') {
            desc = 'Computes the numeric difference between two numbers. <br /> Parameters: <br /> <i>minValue</i>, <i>maxValue</i>. The minimum and maximum values which occur in the datasource';
            innerHTML = '<div class="control-group">';
            innerHTML += '<label class="control-label" for="compare_num_min">minValue:</label>';
            innerHTML += '<div class="controls">';
            innerHTML += '<input type="text" value="0" name="minValue"></input>'
            innerHTML += '</div></div>';
            
            innerHTML += '<div class="control-group">';
            innerHTML += '<label class="control-label" for="compare_num_max">maxValue:</label>';
            innerHTML += '<div class="controls">';
            innerHTML += '<input type="text" value="0" name="maxValue"></input>'
            innerHTML += '</div></div>';

            document.getElementById('special-params').innerHTML = innerHTML;
        } else if (metric == 'date') {
            desc = 'Computes the distance between two dates ("YYYY-MM-DD" format). Returns the difference in days.';
        } else if (metric == 'dateTime') {
            desc = 'Computes the distance between two date time values (xsd:dateTime format). Returns the difference in seconds.';
        } else if (metric == 'wgs84') {
            desc = 'Computes the geographical distance between two points. <br />Parameters: <br /> <i>unit</i>: The unit in which the distance is measured. Allowed values: <i>meter</i> or <i>m</i> (default) , <i>kilometer</i> or <i>km</i>.';
            
            innerHTML = '<div class="control-group">';
            innerHTML += '<label class="control-label" for="wgs84_unit">unit:</label>';
            innerHTML += '<div class="controls">';
            innerHTML += '<input type="text" value="m" name="unit"></input>'
            innerHTML += '</div></div>';
            
            document.getElementById('special-params').innerHTML = innerHTML;
        }
        
        document.getElementById('metric-desc').innerHTML = desc;
    }
    
    function add_transformation() {
        lastElement = document.getElementById('transformation-controls').getElementsByTagName('select').item(document.getElementById('transformation-controls').getElementsByTagName('select').lenght - 1);
        currentCount = lastElement.id.split('_')[1];
        count = parseInt(currentCount) + 1;
        element = lastElement.cloneNode(true);
        element.name = "transformation_" + count.toString();
        element.id = "transformation_" + count.toString();
        
        document.getElementById('transformation-controls').appendChild(document.createElement('br'));
        document.getElementById('transformation-controls').appendChild(document.createElement('br'));
        document.getElementById('transformation-controls').appendChild(element);
    }
    
    function transformation_params(element) {
        document.getElementById('transformation-params').innerHTML = '';
        transformation = element.value;
        desc = '';
        
        if (transformation == "removeBlanks") {
            desc = 'Remove whitespace from a string.';
        } else if (transformation == "removeSpecialChars") {
            desc = 'Remove special characters (including punctuation) from a string.';
        } else if (transformation == "lowerCase") {
            desc = 'Convert a string to lower case.';
        } else if (transformation == "upperCase") {
            desc = 'Convert a string to upper case.';
        } else if (transformation == "capitalize") {
            desc = 'Capitalizes the string i.e. converts the first character to upper case. If <i>allWords</i> is set to true, all words are capitalized and not only the first character. By default <i>allWords</i> is set to false.';
            
            innerHTML = '<div class="control-group">';
            innerHTML += '<label class="control-label" for="transformation_allWords">allWords:</label>';
            innerHTML += '<div class="controls">';
            innerHTML += '<input type="checkbox" name="allWords"></input>'
            innerHTML += '</div></div>';
            
            document.getElementById('transformation-params').innerHTML = innerHTML;
        } else if (transformation == "stem") {
            desc = 'Apply word stemming to the string.';
        } else if (transformation == "alphaReduce") {
            desc = 'Strip all non-alphabetic characters from a string.';
        } else if (transformation == "numReduce") {
            desc = 'Strip all non-numeric characters from a string.';
        } else if (transformation == "replace") {
            desc = 'Replace all occurrences of "search" with <i>replace</i> in a string.';
        } else if (transformation == "regexReplace") {
            desc = 'Replace all occurrences of a regex "regex" with "replace" in a string.';
        } else if (transformation == "stripPrefix") {
            desc = 'Strip the prefix from a string.';
        } else if (transformation == "stripPostfix") {
            desc = 'Strip the postfix from a string.';
        } else if (transformation == "stripUriPrefix") {
            desc = 'Strip the URI prefix (e.g. http://dbpedia.org/resource/) from a string.';
        } else if (transformation == "logarithm") {
            desc = 'Transforms all numbers by applying the logarithm function. Non-numeric values are left unchanged. If base is not defined, it defaults to 10.';
        } else if (transformation == "convert") {
            desc = 'Converts the string from <i>sourceCharset</i> to <i>targetCharset</i>';
        } else if (transformation == "tokenize") {
            desc = 'Splits the string into tokens. Splits at all matches of <i>regex</i> if provided and at whitespaces otherwise.';
        } else if (transformation == "removeValues") {
            desc = 'Removes specific values (i.e. stop words) from the value set. <i>blacklist</i> is a comma-separated list of words.';
        }
        
        document.getElementById('transformation-desc').innerHTML = desc;
    }
  </script>
  
  
  <div>
    <h2>Properties from ${c.orig_dataset_name}</h2>
  </div>
  
  <div class="control-group">
    <label class="control-label" for="orig_property">Property:</label>
    <div class="controls">
        <py:for each="property in c.orig_property_list">
            <input type="radio" name="orig_property" value="${property}">${property}</input><br />
        </py:for>
        <input type="radio" name="orig_property" value="orig_custom">Custom property: <input type="text" name="dest_custom"/></input>
    </div>
  </div>
  
  <div>
    <h3>Transformation Settings <button type="button" id="button" onclick="javascript:add_transformation('+', this)">+</button></h3>
  </div>
  
  <div class="control-group">
    <label class="control-label" for="transformation">Transformation:</label>
    <div class="controls" id="transformation-controls">
        <select name="transformation_0" id="transformation_0" onchange="javascript:transformation_params(this)">
            <option value="None" selected="selected"></option>
            <option value="removeBlanks">Remove Blanks</option>
            <option value="removeSpecialChars">Remove Special Characters</option> 
            <option value="lowerCase">Lower Case</option>
            <option value="upperCase">Upper Case</option>
            <option value="capitalize">Capitalize</option>
            <option value="stem">Word Stemming</option>
            <option value="alphaReduce">Alphanumeric Reduction</option>
            <option value="numReduce">Numeric Reduction</option>
            <option value="replace">Replace</option>
            <option value="regexReplace">Regex Replace</option>
            <option value="stripPrefix">Strip Prefix</option>
            <option value="stripPostfix">Strip Postfix</option>
            <option value="stripUriPrefix">Strip URI Prefix</option>
            <!-- <option value="concat">Concatenate</option>-->
            <option value="logarithm">Logarithm</option>
            <option value="convert">Convert</option>
            <option value="tokenize">Tokenize</option>
            <option value="removeValues">Remove Values</option>
        </select>
        <p id="transformation-desc">
            
        </p>
    </div>
  </div>
  
   <div id="transformation-params">
        
  </div>
  
  <div>
    <h2>Properties from ${c.dest_dataset_name}</h2>
  </div>
  
  <div class="control-group">
    <label class="control-label" for="dest_property">Property:</label>
    <div class="controls">
        <py:for each="property in c.dest_property_list">
            <input type="radio" name="dest_property" value="${property}">${property}</input><br />
        </py:for>
            <input type="radio" name="dest_property" value="dest_custom">Custom property: <input type="text" name="dest_custom"/></input>
    </div>
  </div>
  
  <div>
    <h2>Compare metric settings</h2>
  </div>
  
  <div class="control-group">
    <label class="control-label" for="compare_metric">Compare metric:</label>
    <div class="controls">
        <select name="compare_metric" onchange="javascript:metric_params(this)">
            <option value="None" selected="selected"></option>
            <option>----Character-Based Distance Measures----</option>
            <option value="levenshteinDistance">Levenshtein Distance</option>
            <option value="levenshtein">Normalized Levenshtein Distance</option>
            <option value="jaro">Jaro Distance</option>
            <option value="jaroWinkler">Jaro-Winkler Distance</option>
            <option value="equality">Equality</option>
            <option value="inequality">Inequality</option>
            <option>----Token-Based Distance Measures----</option>
            <option value="jaccard">Jaccard Distance</option>
            <option value="dice">Dice Distance</option>
            <option value="softjaccard">Soft Jaccard Similarity</option>
            <option>----Special Purpose Distance Measures----</option>
            <option value="num">Numeric difference</option>
            <option value="date">Date Distance</option>
            <option value="dateTime">DateTime Distance</option>
            <option value="wgs84">Geographical Distance</option>
        </select>
        <p id="metric-desc">
            
        </p>
    </div>
  </div>
  
  <div class="control-group">
    <label class="control-label" for="compare_required">Required:</label>
    <div class="controls">
        <input type="checkbox" name="required" value="required"/>
    </div>
  </div>
  
  <div class="control-group">
    <label class="control-label" for="compare_weight">Weight:</label>
    <div class="controls">
        <input type="text" value="1" name="weight"></input>
    </div>
  </div>
  
  <div class="control-group">
    <label class="control-label" for="compare_threshold">Threshold:</label>
    <div class="controls">
        <input type="text" value="0.0" name="threshold"></input>
    </div>
  </div>
  
  
  
    <div id="special-params">
        
    </div>
  
  
</form>
